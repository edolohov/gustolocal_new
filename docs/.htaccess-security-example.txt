# ДОПОЛНИТЕЛЬНАЯ ЗАЩИТА ОТ БРУТФОРС-АТАК
# Добавьте эти правила в ваш .htaccess ПОСЛЕ существующих правил

# ============================================
# ЗАЩИТА WP-LOGIN.PHP
# ============================================

# Ограничение частоты запросов к wp-login.php
# (требует mod_rewrite)
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /

# Защита от брутфорс-атак на wp-login.php
# Можно добавить проверку через session или cookie
# Но основная защита уже реализована в functions.php

# Блокировка прямого доступа к wp-login.php с подозрительных IP
# (это можно сделать через плагин или на уровне сервера)
</IfModule>

# ============================================
# БЛОКИРОВКА ПОДОЗРИТЕЛЬНЫХ IP
# ============================================

# Блокировка конкретных IP адресов
# Раскомментируйте и добавьте IP адреса из ваших логов

# <RequireAll>
#     Require all granted
#     Require not ip 196.251.88.101
#     # Добавьте другие IP здесь
#     # Require not ip 123.456.789.0
# </RequireAll>

# Альтернативный способ для Apache 2.2 (если RequireAll не работает)
# <Limit GET POST>
#     order allow,deny
#     deny from 196.251.88.101
#     # deny from 123.456.789.0
#     allow from all
# </Limit>

# ============================================
# ЗАЩИТА ОТ XML-RPC АТАК
# ============================================

# Если вы не используете XML-RPC, заблокируйте его
<Files "xmlrpc.php">
    Order allow,deny
    Deny from all
</Files>

# ============================================
# СКРЫТИЕ ИНФОРМАЦИИ О ВЕРСИИ WORDPRESS
# ============================================

# Удаление информации о версии WordPress из заголовков
<IfModule mod_headers.c>
    Header unset X-Powered-By
    Header always unset X-Powered-By
</IfModule>

# ============================================
# ЗАЩИТА ОТ HOTLINKING И DIRECT ACCESS
# ============================================

# Защита wp-config.php
<Files "wp-config.php">
    Order allow,deny
    Deny from all
</Files>

# Защита .htaccess
<Files ".htaccess">
    Order allow,deny
    Deny from all
</Files>

# ============================================
# ОГРАНИЧЕНИЕ РАЗМЕРА ЗАПРОСА
# ============================================

# Ограничение размера POST запросов (защита от DoS)
LimitRequestBody 10485760

# ============================================
# ВАЖНО: СОХРАНИТЕ СУЩЕСТВУЮЩИЕ ПРАВИЛА
# ============================================

# НЕ УДАЛЯЙТЕ существующие правила из вашего .htaccess:
# - Блокировка опасных файлов
# - Белый список разрешенных файлов
# - WordPress rewrite rules

# Добавьте эти правила ПОСЛЕ существующих, не заменяя их!




